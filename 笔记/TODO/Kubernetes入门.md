# Kubernetes入门

Kubernetes （简称 "K8S"）是由 Google 设计并捐赠给 Cloud Native Computing Foundation (CNCF) 的**开源容器编排系统**，旨在提供一个**跨集群的自动部署、扩展以及管理容器化应用的平台**。
自从去年 10 月 Docker 在 DockerCon 宣布拥抱 Kubernetes，业界普遍认为 Kubernetes 不久将成为容器编排技术的事实标准，以及云原生相关技术的重要组成部分。

最近几年，后端技术的发展也是非常快的，微服务、云计算这几年发展可谓非常迅速，然后还带火了一系列技术；~~以至于现在不会个微服务出去都不好意思说是后端~~，微服务的崛起带火了容器技术，13 年出现的 Docker 可谓大出光彩，然后紧接着 15 年发布了官方的容器编排技术 Docker Swarm，不过随后宣称拥抱 K8S，也就是说.....官方已经放弃 Docker Swarm 转战 K8S，也可以看出他们是搭配使用的，所以学习之前首先需要对 Docker 有一定的了解。

然后再说个现在很火的词，云原生（Cloud Native），简单说它包含了 微服务、DevOps、持续交付、容器化等概念，现在也很火。Docker 还被称为是第三代 PaaS 平台。

使用 Kubernetes 可以：

- 自动化容器的部署和复制（升级）
- 随时扩展或收缩容器规模
- 将容器组织成组，并且提供容器间的负载均衡
- 很容易地升级应用程序容器的新版本
- 提供容器弹性，如果容器失效就替换它
- 等等...

实际上，使用Kubernetes只需一个[部署文件](https://github.com/kubernetes/kubernetes/blob/master/examples/guestbook/all-in-one/guestbook-all-in-one.yaml)，使用一条命令就可以部署多层容器（前端，后台等）的完整集群。
Docker 已经很熟了，它很显然适合无状态服务，但是 DBMS 这种肯定是有状态的，要想做一个平台，肯定要解决有状态的这部分问题，所以 K8S 是有存储这个概念的，并且根据不同的环境分了不同类型的存储。

## 概述

简单贴一下 K8S 的架构图：

分布式和微服务相关的基本知识直接略过了，Node 这种应该都能看懂，etcd 就是存储的：

> Etcd 的官方将它定位成一个可信赖的分布式**键值存储服务**，它能够为整个分布式集群存储些关键数据，协助分布式集群的正常运转.
>
> etcd 和 k8s 一样，都是采用 HTTP 来进行交互，在操作之前先记录日志（小版本 + 大版本），防止丢失。

其他的扩展，例如 ELK 是提供 K8S 集群日志统一分析的一个平台。

## Pod

Pod 是个很重要的概念，一般来说，可以简单分为两类：

- 自主式 Pod

- 控制器管理的 Pod

  除此之外都是自主式的 Pod，而控制器管理的意思就是会根据期望值维持 Pod 的数量，挂了的会自动拉起一个，多了会自动回收

## 拓展

云计算的几个标准：

- Infrastructure as  a Service（IaaS）

  也就是所谓的基础设施级服务，比如阿里云，AWS 之类。

- Platform as a Service（PaaS）

  也就是平台级服务，例如新浪云，你可以上传代码，它负责提供环境和运行，也是 K8S 的主要战场。

- Software as a Service（SaaS）

  软件级别，很常见了，例如在线 Office